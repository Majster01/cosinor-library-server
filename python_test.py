import socketio
import sys
import json
import base64
import tempfile
import csv

sys.path.insert(0,'/home/majster/Documents/diplomska/CosinorPyCustom')

from CosinorPy import file_parser, cosinor, cosinor1
import numpy as np
import pandas as pd
import io

class CommandError(Exception):
  def __init__(self, message):
    super().__init__(message)

def mapToXY(line):
  return [{'x': point[0], 'y': point[1]} for point in line]

def raiseUnsupportedCommandError(csv = None):
  raise CommandError('Unsupported command')

def getCosinorFunction(command):
  switcher={
    'periodogram': periodogram,
    'fit_group': fit_group,
  }

  return switcher.get(command, raiseUnsupportedCommandError)

def periodogram(file):

  if file == None:
    df = file_parser.generate_test_data(phase = 0, n_components = 1, name="test1", noise=0.5, replicates = 1)
  else:
    df = file_parser.read_csv(file, ',')

  print(df)
  pyplot = cosinor.periodogram_df(df)

  lines = pyplot.gca().get_lines()

  return [mapToXY(line.get_xydata().tolist()) for line in lines]

def pyplotToBase64(plot):
  buf = io.BytesIO()
  plot.savefig(buf, format='png')
  buf.seek(0)

  base64bytes = base64.b64encode(buf.read())
  base64_message = base64bytes.decode('utf-8')

  return base64_message

def fit_group_independent(data, cosinorType, options):

  print('fit_group_independent')
  file = getFile(data)
  
  df = file_parser.read_csv(file, '\t')

  figure_image_list = []

  period=options['period']

  response = None

  print('cosinorType == general cosinor')
  print(cosinorType)
  if cosinorType == 'general cosinor':
    n_components = options['n_components']

    plot = True
    if (n_components == [1,2,3]):
      plot = False

    print('before fit_group')
    result_df = cosinor.fit_group(df, n_components = n_components, period=period, plot=plot, figure_image_list=figure_image_list)

    if (plot == False):
      print('before get_best_models')
      df_best_models = cosinor.get_best_models(df, df_models = result_df, n_components = [1,2,3])

      print('before plot_df_models')
      cosinor.plot_df_models(df, df_best_models, plot_residuals=False, figure_image_list=figure_image_list)
      response = df_best_models.to_dict('list')
    else:
      response = result_df.to_dict('list')

  elif cosinorType == 'cosinor1':
    result_df = cosinor1.fit_group(df, period=options['period'], figure_image_list=figure_image_list)
    response = result_df.to_dict('list')

  return json.dumps({
    'graphs': figure_image_list,
    'data': response,
  })

def fit_group_population(data, cosinorType, options):
  file = getFile(data)
  
  df = file_parser.read_csv(file, '\t')

  figure_image_list = []

  if cosinorType == 'general cosinor':

    n_components = options['n_components']

    plot = True
    if (n_components == [1,2,3]):
      plot = False

    result_df = cosinor.population_fit_group(df, n_components = n_components, period=options['period'], plot_measurements = plot, figure_image_list=figure_image_list)

    if (plot == False):
      df_best_models = cosinor.get_best_models_population(df, df_models = result_df, n_components = [1,2,3])

      cosinor.plot_df_models_population(df, df_best_models, figure_image_list=figure_image_list)

      data = df_best_models.to_json(orient='records')
    else:
      data = result_df.to_json(orient='records')
  elif cosinorType == 'cosinor1':
    result_df = cosinor1.population_fit_group(df, period=options['period'], figure_image_list=figure_image_list)

    data = result_df.to_json(orient='records')


  return json.dumps({
    'graphs': figure_image_list,
    'data': json.loads(data),
  })

def comparison_independent(data, cosinorType, options):

  print('comparison_independent')
  file = getFile(data)
  
  df = file_parser.read_csv(file, '\t')

  figure_image_list = []

  period=options['period']

  response = None

  print('cosinorType == general cosinor')
  print(cosinorType)
  if cosinorType == 'general cosinor':
    n_components = options['n_components']

    plot = True
    if (n_components == [1,2,3]):
      plot = False

    print('before fit_group')
    result_df = cosinor.fit_group(df, n_components = n_components, period=period, plot=plot, figure_image_list=figure_image_list)

    if (plot == False):
      print('before get_best_models')
      df_best_models = cosinor.get_best_models(df, df_models = result_df, n_components = [1,2,3])

      print('before plot_df_models')
      cosinor.plot_df_models(df, df_best_models, plot_residuals=False, figure_image_list=figure_image_list)
      response = df_best_models.to_dict('list')
    else:
      response = result_df.to_dict('list')

  elif cosinorType == 'cosinor1':
    result_df = cosinor1.fit_group(df, period=options['period'], figure_image_list=figure_image_list)
    response = result_df.to_dict('list')

  return json.dumps({
    'graphs': figure_image_list,
    'data': response,
  })

def getFile(fileString):
  s = io.StringIO(fileString)

  print(s)

  return io.StringIO(fileString)

def validateGenerateData(payload):
  if 'command' not in payload:
    raiseUnsupportedCommandError()
  if 'options' not in payload:
    raiseUnsupportedCommandError()

  options = payload['options']

  if 'components' not in options:
    components = None
  else:
    components = options['components']

  
  if 'period' not in options:
    period = None
  else:
    period = options['period']

  
  if 'amplitudes' not in options:
    amplitudes = None
  else:
    amplitudes = options['amplitudes']

  
  if 'noise' not in options:
    noise = None
  else:
    noise = options['noise']

  return components, period, amplitudes, noise

csvFileType = 'text/csv'
xlsxFileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'

def getDataFrame(fileType, fileString):
  if fileType == csvFileType:
    file = io.StringIO(fileString)

    return file_parser.read_csv(file, '\t')
  elif fileType == xlsxFileType:
    base64_bytes = fileString.encode('ascii')
    message_bytes = base64.b64decode(base64_bytes)
    file = io.BytesIO(message_bytes)

    return file_parser.read_excel(file)

def generate_data():
  df1 = file_parser.generate_test_data(phase = 0, n_components = 1, name="test1", noise=0.5, replicates = 1)
  df2 = file_parser.generate_test_data(phase = 0, n_components = 1, name="test2", noise=0.5, replicates = 1)

  df = df1.append(df2)

  csv_buffer = io.StringIO()
  file_parser.export_csv(df, csv_buffer)

  csv_string = csv_buffer.getvalue()

  return csv_string


if __name__ == "__main__":
  csv_string = generate_data()

  print('CSV')
  print(csv_string)

  xlsx_string = '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'
  df = getDataFrame(xlsxFileType, xlsx_string)

  figure_image_list = []
  result_df = cosinor.fit_group(df, n_components = 1, period=24, plot=True, figure_image_list=figure_image_list)


  print(result_df)
